<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Advice List</title>
</head>
<body>
    <a href="{% url 'home:home' %}">뒤로가기</a>

    <h1>Advice List</h1>
    <a href="{% url 'home:advice_write' %}">새 조언 작성</a>

    <div class="messages">
        {% for message in messages %}
            <div class="message {% if message.tags == 'error' %}error{% elif message.tags == 'success' %}success{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    </div>

    {% if advices %}
        <ul>
            {% for advice in advices %}
            <li>
                <a href="{% url 'home:advice_detail' advice.id %}">{{ advice.title }}</a><br>
                작성자: {{ advice.author.username }} ({{ advice.author.job_type }})<br>
                {% if advice.photo %}
                    <img src="{{ advice.photo.url }}" alt="{{ advice.title }}" style="width: 100px; height: auto;">
                {% else %}
                    <p>조언 사진 없음</p>
                {% endif %}
                <p>작성 시간: {{ advice.created_at|date:"Y.m.d   A h:i" }}</p>
                <p>좋아요 수: {{ advice.like_count }}</p>
            </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>아직 작성된 조언이 없습니다.</p>
    {% endif %}
    <script>
        // 1초 후 메시지 숨기기
        setTimeout(function() {
            var messages = document.querySelectorAll('.messages .message');
            messages.forEach(function(message) {
                message.style.display = 'none';
            });
        }, 1000);

        // 페이지를 나갈 때 메시지 리셋
        window.addEventListener('beforeunload', function() {
            var messages = document.querySelectorAll('.messages .message');
            messages.forEach(function(message) {
                message.remove();
            });
        });
    </script>
</body>
</html>